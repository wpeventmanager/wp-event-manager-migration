var AdminMigration=(AdminMigration=function(){return{init:function(){jQuery("body").on("click",'.wp-event-manager-migration-upload-file input[type="button"]',AdminMigration.actions.checkFile),jQuery("body").on("click",".wp-event-manager-migration-upload-file .upload-file",AdminMigration.actions.uploadFile),jQuery("body").on("change",".wp-event-manager-migration-mapping-form .migration-field",AdminMigration.actions.selectDataField),jQuery("body").on("click",".wp-event-manager-migration-mapping-form .add-default-value",AdminMigration.actions.addDefaultValue),jQuery("body").on("change",'.wp-event-manager-migration-mapping-form select[class*="default_value_"]',AdminMigration.actions.selectDefaultValue)},actions:{checkFile:function(e){jQuery("span.response-message").addClass("error"),jQuery("span.response-message").html(event_manager_migration_admin.file_type_error)},uploadFile:function(e){var r=wp.media({title:event_manager_migration_admin.media_box_title,multiple:!1}).on("select",function(){var e=r.state().get("selection").first().toJSON(),t=e.filename,a=t.substr(t.lastIndexOf(".")+1);"-1"!=jQuery.inArray(a,["csv","xlsx"])?(jQuery("span.response-message").removeClass("error"),jQuery("span.response-message").html(e.filename),jQuery("input#file_id").attr("value",e.id),jQuery("input#file_type").attr("value",a),jQuery('input[name="wp_event_manager_migration_upload"]').attr("type","submit")):(jQuery("span.response-message").addClass("error"),jQuery("input#file_id").attr("value",""),jQuery("input#file_type").attr("value",""),jQuery("span.response-message").html(event_manager_migration_admin.file_type_error),jQuery('input[name="wp_event_manager_migration_upload"]').attr("type","button"))}).open()},selectDataField:function(e){var t=jQuery(e.target).val(),a=jQuery(e.target).attr("id"),r=jQuery(e.target).find("option:selected").attr("class");jQuery(e.target).attr("data-type",r),jQuery(e.target).attr("data-val",t),1==jQuery(e.target).closest("tr").find(".add-default-value").prop("checked")&&(jQuery(e.target).closest("tr").find(".add-default-value").prop("checked",!1),jQuery(e.target).closest("tr").find('select[class*="default_value_"]').html(""),jQuery(e.target).closest("tr").find('select[class*="default_value_"]').hide(),jQuery(e.target).closest("tr").find('input[class*="default_value_"]').val(""),jQuery(e.target).closest("tr").find('input[class*="default_value_"]').attr("type","hidden")),jQuery("body input."+a).val(""),jQuery("body input."+a).attr("type","hidden"),jQuery(e.target).closest("tr").find('input[class*="taxonomy_field_"]').val(""),"custom-field"==r?(jQuery("body input."+a).val(""),jQuery("body input."+a).attr("type","text")):"taxonomy"==r?jQuery(e.target).closest("tr").find('input[class*="taxonomy_field_"]').val(t):(jQuery("body input."+a).val(t),jQuery("body input."+a).attr("type","hidden")),"-1"!=jQuery.inArray(t,["_post_id","_event_organizer_ids","_event_venue_ids"])&&(jQuery(e.target).closest("tr").find("span.wp-event-manager-migration-help-tip").addClass("show-help-tip"),"_post_id"==t?jQuery(e.target).closest("tr").find("span.wp-event-manager-migration-help-tip").attr("title",event_manager_migration_admin._post_id):"_event_organizer_ids"==t?jQuery(e.target).closest("tr").find("span.wp-event-manager-migration-help-tip").attr("title",event_manager_migration_admin._event_organizer_ids):"_event_venue_ids"==t&&jQuery(e.target).closest("tr").find("span.wp-event-manager-migration-help-tip").attr("title",event_manager_migration_admin._event_venue_ids))},addDefaultValue:function(e){var t,a=jQuery(e.target).closest("tr").find(".migration-field").attr("data-type"),r=jQuery(e.target).closest("tr").find(".migration-field").attr("data-val"),n=jQuery(e.target).attr("id");1==jQuery(e.target).prop("checked")?(jQuery("body input."+n).val(""),"taxonomy"==a?(jQuery("body select."+n).show(),t={action:"get_migration_terms",taxonomy:r},jQuery.post(event_manager_migration_admin.ajax_url,t,function(e){jQuery("body select."+n).html(e)},"html")):jQuery("body input."+n).attr("type","text")):(jQuery("body input."+n).val(""),jQuery("body input."+n).attr("type","hidden"),jQuery("body select."+n).html(""),jQuery("body select."+n).hide())},selectDefaultValue:function(e){var t=jQuery(e.target).attr("class"),a=jQuery(e.target).val();jQuery("body input."+t).val(a)}}}})();jQuery(document).ready(function(e){AdminMigration.init()});