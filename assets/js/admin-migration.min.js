var AdminMigration=function(){return{init:function(){jQuery("body").on("click",'.wp-event-manager-migration-upload-file input[type="button"]',AdminMigration.actions.checkFile),jQuery("body").on("click",".wp-event-manager-migration-upload-file .upload-file",AdminMigration.actions.uploadFile),jQuery("body").on("change",".wp-event-manager-migration-mapping-form .migration-field",AdminMigration.actions.selectDataField),jQuery("body").on("click",".wp-event-manager-migration-mapping-form .add-default-value",AdminMigration.actions.addDefaultValue),jQuery("body").on("change",'.wp-event-manager-migration-mapping-form select[class*="default_value_"]',AdminMigration.actions.selectDefaultValue)},actions:{checkFile:function(t){jQuery("span.response-message").addClass("error"),jQuery("span.response-message").html(event_manager_migration_admin.file_type_error)},uploadFile:function(t){var e=wp.media({title:event_manager_migration_admin.media_box_title,multiple:!1}).on("select",function(){var t=e.state().get("selection").first().toJSON(),a=t.filename,i=a.substr(a.lastIndexOf(".")+1);"-1"!=jQuery.inArray(i,["csv","xlsx","xls","xml"])?(jQuery("span.response-message").removeClass("error"),jQuery("span.response-message").html(t.filename),jQuery("input#file_id").attr("value",t.id),jQuery("input#file_type").attr("value",i),jQuery('input[name="wp_event_manager_migration_upload"]').attr("type","submit")):(jQuery("span.response-message").addClass("error"),jQuery("input#file_id").attr("value",""),jQuery("input#file_type").attr("value",""),jQuery("span.response-message").html(event_manager_migration_admin.file_type_error),jQuery('input[name="wp_event_manager_migration_upload"]').attr("type","button"))}).open()},selectDataField:function(t){var e=jQuery(t.target).val(),a=jQuery(t.target).attr("id"),i=jQuery(t.target).find("option:selected").attr("class");jQuery(t.target).attr("data-type",i),jQuery(t.target).attr("data-val",e),!0==jQuery(t.target).closest("tr").find(".add-default-value").prop("checked")&&(jQuery(t.target).closest("tr").find(".add-default-value").prop("checked",!1),jQuery(t.target).closest("tr").find('select[class*="default_value_"]').html(""),jQuery(t.target).closest("tr").find('select[class*="default_value_"]').hide(),jQuery(t.target).closest("tr").find('input[class*="default_value_"]').val(""),jQuery(t.target).closest("tr").find('input[class*="default_value_"]').attr("type","hidden")),jQuery("body input."+a).val(""),jQuery("body input."+a).attr("type","hidden"),jQuery(t.target).closest("tr").find('input[class*="taxonomy_field_"]').val(""),"custom-field"==i?(jQuery("body input."+a).val(""),jQuery("body input."+a).attr("type","text")):"taxonomy"==i?jQuery(t.target).closest("tr").find('input[class*="taxonomy_field_"]').val(e):(jQuery("body input."+a).val(e),jQuery("body input."+a).attr("type","hidden")),"-1"!=jQuery.inArray(e,["_post_id","_event_organizer_ids","_event_venue_ids"])&&(jQuery(t.target).closest("tr").find("span.wp-event-manager-migration-help-tip").addClass("show-help-tip"),"_post_id"==e?jQuery(t.target).closest("tr").find("span.wp-event-manager-migration-help-tip").attr("title",event_manager_migration_admin._post_id):"_event_organizer_ids"==e?jQuery(t.target).closest("tr").find("span.wp-event-manager-migration-help-tip").attr("title",event_manager_migration_admin._event_organizer_ids):"_event_venue_ids"==e&&jQuery(t.target).closest("tr").find("span.wp-event-manager-migration-help-tip").attr("title",event_manager_migration_admin._event_venue_ids))},addDefaultValue:function(t){var e=jQuery(t.target).closest("tr").find(".migration-field").attr("data-type"),a=jQuery(t.target).closest("tr").find(".migration-field").attr("data-val"),i=jQuery(t.target).attr("id");if(!0==jQuery(t.target).prop("checked")){if(jQuery("body input."+i).val(""),"taxonomy"==e){jQuery("body select."+i).show();var n={action:"get_migration_terms",taxonomy:a};jQuery.post(event_manager_migration_admin.ajax_url,n,function(t){jQuery("body select."+i).html(t)},"html")}else jQuery("body input."+i).attr("type","text")}else jQuery("body input."+i).val(""),jQuery("body input."+i).attr("type","hidden"),jQuery("body select."+i).html(""),jQuery("body select."+i).hide()},selectDefaultValue:function(t){var e=jQuery(t.target).attr("class"),a=jQuery(t.target).val();jQuery("body input."+e).val(a)}}}};AdminMigration=AdminMigration(),jQuery(document).ready(function(t){AdminMigration.init()});